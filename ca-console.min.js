/**
* Console AngularJS Module v1.0.0
* https://github.com/albulescu/angular-ca-console
*
* Author Albulescu Cosmin <cosmin@albulescu.ro>
* Licensed under the MIT license.
*/

"use strict";angular.module("ca.console.templates",[]).run(["$templateCache",function(a){a.put("ca-console/directive/console.html",'<div tabindex=-1 class="ca-console ng-cloak" ng-show=visible ng-init=init() ng-style=style><div class=ca-console-header></div><div class=ca-console-body auto-scroll=true><ul><li ng-class=classes[log.type] ng-repeat="log in logs">{{log.body}}</li></ul></div><div class=ca-console-command><input ng-model=command ng-keydown=keydown($event)></div><div class=ca-console-move title="Move console"></div><div class=ca-console-close title="Close console" ng-click=console.hide()></div><div class=ca-console-resize title="Resize console"></div></div>')}]),angular.module("ca.console",["ca.console.templates"]).constant("DEFAULT_SIZE",[600,250]).provider("$console",function(){var a={};this.overrideBrowserConsole=function(){a.overrideBrowserConsole=!0},this.showPassword=function(b){a.showPassword=b},this.position=function(b){a.position=b},this.appendTo=function(b){a.appendTo=b},this.logLevel=function(b){a.logLevel=b},this.$get=["$rootScope","$timeout","$document","$compile","$http","$templateCache",function(b,c,d,e,f,g){function h(){function a(a){g=a.screenY-e,f=a.screenX-c,m.css({top:g+"px",left:f+"px"})}function b(){d.off("mousemove",a),d.off("mouseup",b)}var c=m.offset().left,e=m.offset().top,f=c,g=e;m.find(".ca-console-move").on("mousedown",function(h){h.preventDefault(),c=h.screenX-f,e=h.screenY-g,d.on("mousemove",a),d.on("mouseup",b)})}function i(){f.get("ca-console/directive/console.html",{cache:g}).success(function(a){m=angular.element(a),angular.element("body").append(m),e(m)(l),h()})}function j(a){return function(){var b=Array.prototype.slice.call(arguments);l.logs.push({body:b.join(", "),type:a,time:(new Date).getTime()}),l.$digest()}}var k={HIDE_ON_BLUR:"hideOnBlur",USE_ANIMATIONS:"useAnimations",LOG_NORMAL:1,LOG_INFO:2,LOG_DEBUG:4,LOG_WARN:8,LOG_ERROR:16,LOG_ALL:32},l=b.$new(!0),m=null,n=(angular.noop,{});l.visible=null,l.style={},l.logs=[],l.command="",l.filter="",l.flags=1,l.classes={1:"log",2:"info",4:"debug",8:"warn",16:"error"},l.$watch("visible",function(a){"boolean"!=typeof a||m||i()});var o=function(){angular.extend(this,k),l.console=this};o.prototype.log=function(){m.scope().log.apply(this.element.scope().log,arguments)},o.prototype.command=function(a,b,c){n[a]=c?b.bind(c):b},o.prototype.exec=function(){if(0===arguments.length)throw new Error("ecnr");var a=Array.prototype.slice.call(arguments),b=n[a.shift()]||angular.noop;b.apply(void 0,a)},o.prototype.hide=function(){l.visible=!1},o.prototype.show=function(){l.visible=!0},o.prototype.toggle=function(){l.visible=!l.visible},o.prototype.log=j(k.LOG_NORMAL),o.prototype.info=j(k.LOG_INFO),o.prototype.warn=j(k.LOG_WARN),o.prototype.error=j(k.LOG_ERROR);var p,q=[];angular.element(document).keypress(function(b){q.push(String.fromCharCode(b.keyCode)),q.join("")===a.showPassword&&l.show(),c.cancel(p),p=c(function(){q=[]},3e3)});var r=new o;return a.overrideBrowserConsole&&(console.log=r.log,console.info=r.info,console.debug=r.debug,console.error=r.error,console.warn=r.warn),a.logLevel&&(l.flags=a.logLevel),r}]}),angular.module("ca.console").controller("ConsoleController",["$scope","$document","$element",function(a,b,c){a.style={},a.classes={0:["log"],2:["info"],4:["warn"],16:["error"],128:["data-in"],256:["data-out"]},a.logs=[],a.init=function(){function d(a){i=a.screenY-g,h=a.screenX-f,c.css({top:i+"px",left:h+"px"})}function e(){b.off("mousemove",d),b.off("mouseup",e)}var f=c.offset().left,g=c.offset().top,h=f,i=g;c.find(".ca-console-move").on("mousedown",function(a){a.preventDefault(),f=a.screenX-h,g=a.screenY-i,b.on("mousemove",d),b.on("mouseup",e)}),a.$watch("name",function(b){if(angular.isDefined(a.$parent.name))throw new Error('The property "'+b+'" already defined on console parent scope');a.$parent.name=a,a.$parent.$emit("console.ready",a,b)})},a.show=function(){c.show()},a.hide=function(){c.hide()},a.toggle=function(){c.toggle()},a.option=function(){}}]),angular.module("ca.console").directive("autoScroll",["$timeout","$q","$parse","$log",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){if("auto"!==f.css("overflow"))return d.warn("Element is not scrollable. Auto scroll has no sense!");var h,i=e.$eval(g.autoScroll),j=i||!0,k=function(a){var b=!1;this.target=a,this.preventDefault=function(){b=!0},this.isDefaultPrevented=function(){return b}};e.$on("$enableAutoScroll",function(){j||d.info("Enable autoscroll"),j=!0}),e.$on("$disableAutoScroll",function(){j&&d.info("Disable autoscroll"),j=!1}),f.on("wheel",function(a){var b=a.originalEvent.detail?-120*a.originalEvent.detail:a.originalEvent.wheelDelta;return b>0?void(j=!1):void(f.get(0).scrollTop>=f.get(0).scrollHeight-f.height()&&(j=!0))}),f.on("DOMNodeInserted",function(d){var l=d.srcElement||d.target,m=d.delegateTarget;1===l.nodeType&&j===!0&&i===!0&&(a.cancel(h),h=a(function(){var a=new k(f),d={$event:a},h=c(g.autoScrollTrigger)||angular.noop,i=h(e,d);i&&b.when(i).then(function(){m.scrollTop=m.scrollHeight}),a.isDefaultPrevented()||(m.scrollTop=m.scrollHeight)}))})}}}]),angular.module("ca.console").directive("console",function(){return{restrict:"EA",scope:{name:"@"},controller:"ConsoleController",templateUrl:"ca-console/directive/console.html"}});