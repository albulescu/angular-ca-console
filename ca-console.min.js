/**
* Console AngularJS Module v1.0.0
* https://github.com/albulescu/angular-ca-console
*
* Author Albulescu Cosmin <cosmin@albulescu.ro>
* Licensed under the MIT license.
*/

"use strict";angular.module("ca.console.templates",[]).run(["$templateCache",function(a){a.put("ca-console/directive/console.html",'<div tabindex=-1 class="ca-console ng-cloak" ng-show=visible ng-init=init() ng-style=style><div class=ca-console-header></div><div class=ca-console-body auto-scroll=true><ul><li ng-class=classes[log.type] ng-repeat="log in logs">{{log.body}}</li></ul></div><div class=ca-console-command><input ng-model=command ng-keydown=keydown($event)></div><div class=ca-console-move title="Move console"></div><div class=ca-console-close title="Close console" ng-click=console.hide()></div><div class=ca-console-resize title="Resize console"></div></div>')}]),angular.module("ca.console",["ca.console.templates"]).constant("DEFAULT_SIZE",[600,250]).provider("$console",function(){var a={};this.overrideBrowserConsole=function(){a.overrideBrowserConsole=!0},this.showPassword=function(b){a.showPassword=b},this.position=function(b){a.position=b},this.appendTo=function(b){a.appendTo=b},this.logLevel=function(b){a.logLevel=b},this.$get=["$rootScope","$timeout","$document","$compile","$http","$templateCache",function(b,c,d,e,f,g){function h(){function a(){n.resize(h+(event.screenX-j),i+(event.screenY-k)),l.$emit("resize")}function b(){d.off("mousemove",a),d.off("mouseup",b)}function c(a){p=a.screenY-g,o=a.screenX-f,m.css({top:p+"px",left:o+"px"}),l.$emit("move",o,p)}function e(){d.off("mousemove",c),d.off("mouseup",e),l.$emit("move.complete")}var f=m.offset().left,g=m.offset().top,h=m.width(),i=m.height(),j=0,k=0,o=f,p=g;m.find(".ca-console-move").on("mousedown",function(a){a.preventDefault(),f=a.screenX-o,g=a.screenY-p,d.on("mousemove",c),d.on("mouseup",e),l.$emit("move.start")}),m.find(".ca-console-resize").on("mousedown",function(c){c.preventDefault(),h=m.width(),i=m.height(),j=c.screenX,k=c.screenY,d.on("mousemove",a),d.on("mouseup",b),l.$emit("resize.start")})}function i(){f.get("ca-console/directive/console.html",{cache:g}).success(function(a){m=angular.element(a),angular.element("body").append(m),e(m)(l),h()})}function j(a){return function(){var b=Array.prototype.slice.call(arguments);l.logs.push({body:b.join(", "),type:a,time:(new Date).getTime()})}}var k={HIDE_ON_BLUR:"hideOnBlur",USE_ANIMATIONS:"useAnimations",LOG_NORMAL:1,LOG_INFO:2,LOG_DEBUG:4,LOG_WARN:8,LOG_ERROR:16,LOG_ALL:32},l=b.$new(!0),m=null,n=null,o={};l.visible=null,l.style={},l.logs=[],l.command="",l.filter="",l.flags=1,l.classes={1:"log",2:"info",4:"debug",8:"warn",16:"error"},l.$watch("visible",function(a){"boolean"!=typeof a||m||i()});var p=function(){angular.extend(this,k),l.console=this};p.prototype.log=function(){m.scope().log.apply(this.element.scope().log,arguments)},p.prototype.command=function(a,b,c){o[a]=c?b.bind(c):b},p.prototype.exec=function(){if(0===arguments.length)throw new Error("ecnr");var a=Array.prototype.slice.call(arguments),b=o[a.shift()]||angular.noop;b.apply(void 0,a)},p.prototype.hide=function(){l.visible=!1,l.$emit("hide")},p.prototype.show=function(){l.visible=!0,l.$emit("hide")},p.prototype.toggle=function(){l.visible?l.hide():l.show()},p.prototype.resize=function(a,b){a>400&&(l.style.width=a),b>200&&(l.style.height=b),l.$emit("resize.complete"),l.$digest()},p.prototype.log=j(k.LOG_NORMAL),p.prototype.info=j(k.LOG_INFO),p.prototype.warn=j(k.LOG_WARN),p.prototype.error=j(k.LOG_ERROR),p.prototype.on=function(a,b){return l.$on(a,b)},p.prototype.emit=function(){return l.$emit.apply(l,arguments)};var q,r=[];return angular.element(document).keypress(function(b){r.push(String.fromCharCode(b.keyCode)),r.join("")===a.showPassword&&l.show(),c.cancel(q),q=c(function(){r=[]},3e3)}),n=new p,a.overrideBrowserConsole&&(console.log=n.log,console.info=n.info,console.debug=n.debug,console.error=n.error,console.warn=n.warn),a.logLevel&&(l.flags=a.logLevel),n}]}),angular.module("ca.console").directive("autoScroll",["$timeout","$q","$parse","$log",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){if("auto"!==f.css("overflow"))return d.warn("Element is not scrollable. Auto scroll has no sense!");var h,i=e.$eval(g.autoScroll),j=i||!0,k=function(a){var b=!1;this.target=a,this.preventDefault=function(){b=!0},this.isDefaultPrevented=function(){return b}};e.$on("$enableAutoScroll",function(){j||d.info("Enable autoscroll"),j=!0}),e.$on("$disableAutoScroll",function(){j&&d.info("Disable autoscroll"),j=!1}),f.on("wheel",function(a){var b=a.originalEvent.detail?-120*a.originalEvent.detail:a.originalEvent.wheelDelta;return b>0?void(j=!1):void(f.get(0).scrollTop>=f.get(0).scrollHeight-f.height()&&(j=!0))}),f.on("DOMNodeInserted",function(d){var l=d.srcElement||d.target,m=d.delegateTarget;1===l.nodeType&&j===!0&&i===!0&&(a.cancel(h),h=a(function(){var a=new k(f),d={$event:a},h=c(g.autoScrollTrigger)||angular.noop,i=h(e,d);i&&b.when(i).then(function(){m.scrollTop=m.scrollHeight}),a.isDefaultPrevented()||(m.scrollTop=m.scrollHeight)}))})}}}]),angular.module("ca.console").directive("console",function(){return{restrict:"EA",scope:{name:"@"},controller:"ConsoleController",templateUrl:"ca-console/directive/console.html"}});